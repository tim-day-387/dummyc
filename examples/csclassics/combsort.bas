10 REM COMBSORT PROGRAM
20 REM RANDOMIZE
30 DIM A(1000)
40 FOR I=0 TO 999 STEP 1
50 LET A(I)=INT(RND*1000)
60 NEXT I
70 GOSUB 500
80 FOR I=0 TO 998 STEP 1
90 IF A(I)<=A(I+1) THEN 120
100 PRINT "SORT FAILED"
110 GOTO 140
120 NEXT I
130 PRINT "SORT SUCCEEDED"
140 GOSUB 900
150 STOP
500 REM COMBSORT SUBROUTINE
505 REM G IS GAP, S IS SHRINK FACTOR, S1 IS SWAPPED FLAG (1 IS TRUE)
510 LET G=999
520 LET S=1.3
525 LET S1=1
530 IF G<>1 THEN 560
540 IF S1<>0 THEN 560
550 GOTO 690
560 LET G=INT(G/S)
570 IF G>=1 THEN 590
580 LET G=1
590 LET I=0
600 LET S1=0
610 IF I+G>999 THEN 540
620 IF A(I)<=A(I+G) THEN 660
630 LET T=A(I)
640 LET A(I)=A(I+G)
650 LET A(I+G)=T
655 LET S1=1
660 LET I=I+1
670 GOTO 610
690 RETURN
900 REM DUMP ARRAY CONTENTS
910 FOR I=0 TO 999 STEP 1
920 PRINT A(I),
930 NEXT I
940 PRINT
950 RETURN
960 END
